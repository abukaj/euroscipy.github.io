name: connect via ssh

on:
  push:
    branches:
      - develop
      - ssh_test
  pull_request:
    branches:
      - develop
      - ssh_test

jobs:
  build:

    runs-on: ubuntu-latest
    env:
      SSH_KEY: ${{ secrets.SSH_KEY }}
      SSH_KNOWN_HOST: ${{ secrets.SSH_KNOWN_HOST }}

    steps:
    - uses: actions/checkout@v1
    - name: Run a one-line script
      run: echo Hello, world!
    - name: Run a multi-line script
      run: |
        mkdir ~/.ssh
        python3 write_key.py
        wc -l id_ssh ~/.ssh/known_hosts
        chmod og-rwx id_ssh ~/.ssh/known_hosts
        ls -lh id_ssh ~/.ssh/known_hosts
        ssh -vv -i id_ssh gh_euroscipy@euroscipy.g-node.org ls

